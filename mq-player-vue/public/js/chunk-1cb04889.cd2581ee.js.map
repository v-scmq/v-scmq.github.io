{"version":3,"sources":["webpack:///./src/renderer/views/SpecialList.vue?4baa","webpack:///./src/renderer/views/SpecialList.vue?b755","webpack:///./src/renderer/views/SpecialList.vue?e5f4","webpack:///./src/renderer/views/SpecialList.vue"],"names":["_withScopeId","n","_pushScopeId","_popScopeId","_hoisted_1","_hoisted_2","_createElementVNode","class","_hoisted_3","_hoisted_4","render","_ctx","_cache","$props","$setup","$data","$options","_component_image_view","_resolveComponent","_component_grid_view","_component_modal","_openBlock","_createElementBlock","_Fragment","onClick","args","onListViewClicked","_renderList","visibleTags","tag","_normalizeClass","active","specialTagParam","id","key","_toDisplayString","name","_createVNode","style","data","specialList","onInfiniteScroll","loadData","default","_withCtx","item","modelValue","cover","$event","defaultValue","_","modality","title","width","height","visible","tagModal","content","tags","_index","_createTextVNode","items","index","defineComponent","setup","reactive","page","current","size","ref","onMounted","Spinner","open","getSpecialList","then","Object","assign","splice","length","list","random","Math","forEach","children","push","finally","close","event","node","target","classList","contains","value","getAttribute","pageCount","catch","__exports__"],"mappings":"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","file":"public/js/chunk-1cb04889.cd2581ee.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./SpecialList.vue?vue&type=style&index=0&id=28a1979b&scoped=true&lang=css\"","import { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, createTextVNode as _createTextVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-28a1979b\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = [\"data-id\"]\nconst _hoisted_2 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", { class: \"item special-tag-more\" }, \"更多\", -1))\nconst _hoisted_3 = { class: \"name\" }\nconst _hoisted_4 = [\"data-id\"]\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_image_view = _resolveComponent(\"image-view\")!\n  const _component_grid_view = _resolveComponent(\"grid-view\")!\n  const _component_modal = _resolveComponent(\"modal\")!\n\n  return (_openBlock(), _createElementBlock(_Fragment, null, [\n    _createElementVNode(\"div\", {\n      class: \"v-row list-view\",\n      onClick: _cache[0] || (_cache[0] = \n//@ts-ignore\n(...args) => (_ctx.onListViewClicked && _ctx.onListViewClicked(...args)))\n    }, [\n      (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.visibleTags, (tag) => {\n        return (_openBlock(), _createElementBlock(\"div\", {\n          class: _normalizeClass([\"item\", {active: _ctx.specialTagParam.id === tag.id}]),\n          key: tag.id,\n          \"data-id\": tag.id\n        }, _toDisplayString(tag.name), 11, _hoisted_1))\n      }), 128)),\n      _hoisted_2\n    ]),\n    _createVNode(_component_grid_view, {\n      style: {\"margin-top\":\"1em\"},\n      data: _ctx.specialList,\n      \"cell-widths\": \"repeat(auto-fit, 13em)\",\n      \"cell-height\": 234,\n      onInfiniteScroll: _ctx.loadData\n    }, {\n      default: _withCtx(({item}) => [\n        _createVNode(_component_image_view, {\n          modelValue: item.cover,\n          \"onUpdate:modelValue\": ($event: any) => ((item.cover) = $event),\n          defaultValue: \"/icon/special.png\"\n        }, null, 8, [\"modelValue\", \"onUpdate:modelValue\"]),\n        _createElementVNode(\"div\", _hoisted_3, _toDisplayString(item.name), 1)\n      ]),\n      _: 1\n    }, 8, [\"data\", \"onInfiniteScroll\"]),\n    _createVNode(_component_modal, {\n      modality: \"\",\n      title: \"全部分类\",\n      width: \"70%\",\n      height: \"60%\",\n      visible: _ctx.tagModal,\n      \"onUpdate:visible\": _cache[2] || (_cache[2] = ($event: any) => ((_ctx.tagModal) = $event))\n    }, {\n      content: _withCtx(() => [\n        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.tags, (item, _index) => {\n          return (_openBlock(), _createElementBlock(_Fragment, { key: _index }, [\n            _createTextVNode(_toDisplayString(item.title) + \" \", 1),\n            _createElementVNode(\"div\", {\n              class: \"v-row list-view\",\n              onClick: _cache[1] || (_cache[1] = \n//@ts-ignore\n(...args) => (_ctx.onListViewClicked && _ctx.onListViewClicked(...args)))\n            }, [\n              (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(item.items, (tag, index) => {\n                return (_openBlock(), _createElementBlock(\"div\", {\n                  class: _normalizeClass([\"item\", {active: _ctx.specialTagParam.id === tag.id}]),\n                  key: index,\n                  \"data-id\": tag.id\n                }, _toDisplayString(tag.name), 11, _hoisted_4))\n              }), 128))\n            ])\n          ], 64))\n        }), 128))\n      ]),\n      _: 1\n    }, 8, [\"visible\"])\n  ], 64))\n}","\r\nimport {getSpecialList} from '../api';\r\nimport Spinner from '../components/Spinner';\r\n\r\nimport {ComputedPage, Special, SpecialTags, Tag} from 'src/types';\r\n\r\nimport {onMounted, reactive, ref, defineComponent} from 'vue';\r\n\r\nexport default defineComponent({\r\n  name: 'SpecialList',\r\n\r\n  setup() {\r\n    // 所有歌单分类标签\r\n    const tags = reactive<SpecialTags[]>([]);\r\n    // 可见的歌单分类标签列表\r\n    const visibleTags = reactive<Tag[]>([]);\r\n    // 歌单列表\r\n    const specialList = reactive<Special[]>([]);\r\n    // 当前已选Tag的id\r\n    const specialTagParam = reactive<Tag>({id: ''});\r\n    // 分页信息\r\n    const page = {current: 1, size: 30} as ComputedPage;\r\n\r\n    // 显示分类标签的模态框显隐控制\r\n    const tagModal = ref(false);\r\n\r\n    onMounted(() => {\r\n      Spinner.open();\r\n\r\n      getSpecialList(page, null).then(data => {\r\n        data.page && Object.assign(page, data.page);\r\n        data.tags && tags.splice(0, tags.length, ...data.tags);\r\n        specialList.splice(0, specialList.length, ...data.list);\r\n\r\n        const random = Math.random();\r\n\r\n        data.tags && data.tags.forEach(item => {\r\n          const children = item.items;\r\n          const tag = children[(random * children.length) ^ 0];\r\n          tag && visibleTags.push(tag);\r\n        });\r\n\r\n        // 断言能够获得数据\r\n        const [{items: [tag]}] = data.tags || [];\r\n        tag && Object.assign(specialTagParam, tag);\r\n\r\n      }).finally(Spinner.close);\r\n\r\n    });\r\n\r\n    return {\r\n      tags, specialList, visibleTags, tagModal, specialTagParam,\r\n\r\n      /**\r\n       * 若点击分类标签时,切换歌单数据;\r\n       * 若点击更多分类时,则打开歌单详细分类标签模态框\r\n       *\r\n       * @param event 点击事件\r\n       */\r\n      onListViewClicked(event: PointerEvent) {\r\n        const node = event.target as HTMLElement, classList = node.classList;\r\n        if (classList.contains('special-tag-more')) {\r\n          return tagModal.value = true;\r\n        }\r\n\r\n        const value = node.getAttribute('data-id');\r\n\r\n        if (value && value !== specialTagParam.id) {\r\n          specialTagParam.id = value;\r\n\r\n          Spinner.open();\r\n          page.current = 1;\r\n\r\n          getSpecialList(page, specialTagParam).then(data => {\r\n            data.page && Object.assign(page, data.page);\r\n            specialList.splice(0, specialList.length, ...data.list);\r\n\r\n          }).finally(Spinner.close);\r\n        }\r\n      },\r\n\r\n      /** 加载数据到视图上(无限滚动触发点) */\r\n      loadData() {\r\n        // 若还有数据, 则发起网络请求加载歌曲数据列表\r\n        if (page.current >= 1 && page.current < page.pageCount) {\r\n          Spinner.open();\r\n\r\n          ++page.current;\r\n\r\n          getSpecialList(page, specialTagParam).then(data => {\r\n            data.page && Object.assign(page, data.page);\r\n            specialList.push(...data.list);\r\n\r\n          }).catch(() => --page.current).finally(Spinner.close);\r\n        }\r\n      }\r\n\r\n    };\r\n\r\n  }\r\n\r\n});\r\n","import { render } from \"./SpecialList.vue?vue&type=template&id=28a1979b&scoped=true&ts=true\"\nimport script from \"./SpecialList.vue?vue&type=script&lang=ts\"\nexport * from \"./SpecialList.vue?vue&type=script&lang=ts\"\n\nimport \"./SpecialList.vue?vue&type=style&index=0&id=28a1979b&scoped=true&lang=css\"\n\nimport exportComponent from \"D:\\\\SCMQ\\\\project\\\\HTML\\\\mq-player-vue\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-28a1979b\"]])\n\nexport default __exports__"],"sourceRoot":""}