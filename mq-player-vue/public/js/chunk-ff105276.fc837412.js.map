{"version":3,"sources":["webpack:///./src/renderer/views/MVList.vue?1357","webpack:///./src/renderer/views/MVList.vue?6fdb","webpack:///./src/renderer/views/MVList.vue","webpack:///./src/renderer/views/MVList.vue?6fd8"],"names":["_hoisted_1","_hoisted_2","_hoisted_3","render","_ctx","_cache","$props","$setup","$data","$options","_component_image_view","_component_grid_view","tags","children","index","class","key","onClick","args","onListViewClicked","tag","active","id","mvTagParam","group","value","name","style","data","mvList","onInfiniteScroll","loadData","default","item","modelValue","cover","$event","defaultValue","singer","mid","title","_","page","current","size","Spinner","open","then","Object","assign","tagList","keys","forEach","property","push","splice","length","list","finally","close","event","target","getAttribute","split","pageCount","catch","__exports__"],"mappings":"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","file":"public/js/chunk-ff105276.fc837412.js","sourcesContent":["import { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, resolveComponent as _resolveComponent, createVNode as _createVNode, createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, withCtx as _withCtx, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-4c634498\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = [\"data-tag\"]\nconst _hoisted_2 = [\"data-mid\"]\nconst _hoisted_3 = /*#__PURE__*/_createTextVNode(\" -\")\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_image_view = _resolveComponent(\"image-view\")!\n  const _component_grid_view = _resolveComponent(\"grid-view\")!\n\n  return (_openBlock(), _createElementBlock(_Fragment, null, [\n    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.tags, (children, index) => {\n      return (_openBlock(), _createElementBlock(\"div\", {\n        class: \"v-row list-view\",\n        key: index,\n        onClick: _cache[0] || (_cache[0] = \n//@ts-ignore\n(...args) => (_ctx.onListViewClicked && _ctx.onListViewClicked(...args)))\n      }, [\n        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(children, (tag) => {\n          return (_openBlock(), _createElementBlock(\"div\", {\n            class: _normalizeClass([\"item\", {active: tag.id === _ctx.mvTagParam[tag.group]}]),\n            key: tag.id,\n            \"data-tag\": tag.value\n          }, _toDisplayString(tag.name), 11, _hoisted_1))\n        }), 128))\n      ]))\n    }), 128)),\n    _createVNode(_component_grid_view, {\n      class: \"arc-rect\",\n      style: {\"margin-top\":\"1em\"},\n      \"cell-widths\": \"repeat(auto-fit, 16em)\",\n      data: _ctx.mvList,\n      \"cell-height\": 206,\n      onInfiniteScroll: _ctx.loadData\n    }, {\n      default: _withCtx(({item}) => [\n        _createVNode(_component_image_view, {\n          modelValue: item.cover,\n          \"onUpdate:modelValue\": ($event: any) => ((item.cover) = $event),\n          defaultValue: \"icon/mv.png\"\n        }, null, 8, [\"modelValue\", \"onUpdate:modelValue\"]),\n        _createElementVNode(\"div\", null, [\n          (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(item.singer, (singer, index) => {\n            return (_openBlock(), _createElementBlock(\"span\", {\n              class: \"link\",\n              key: index,\n              \"data-mid\": singer.mid\n            }, _toDisplayString(singer.name), 9, _hoisted_2))\n          }), 128)),\n          _hoisted_3,\n          _createElementVNode(\"span\", null, _toDisplayString(item.title), 1)\n        ])\n      ]),\n      _: 1\n    }, 8, [\"data\", \"onInfiniteScroll\"])\n  ], 64))\n}","\r\nimport {getMvList} from '../api';\r\nimport Spinner from '../components/Spinner';\r\n\r\nimport {reactive, onMounted, defineComponent} from 'vue';\r\nimport {ComputedPage, Mv, MvTagsParam} from 'src/types';\r\n\r\n/**\r\n * tag标签节点信息\r\n */\r\ntype TagItemNode = {\r\n  /** 分类标签名称  */\r\n  name: string;\r\n  /** 分类标签id  */\r\n  id: string | number;\r\n  /** 所属分类组  */\r\n  group: string;\r\n  /** `${分类标签分类组}-${分类标签id}`  */\r\n  value: string;\r\n};\r\n\r\nexport default defineComponent({\r\n  name: 'MVList',\r\n\r\n  setup() {\r\n    const tags = reactive<TagItemNode[][]>([]);\r\n    const mvList = reactive<Mv[]>([]);\r\n    const mvTagParam = reactive<MvTagsParam>({} as MvTagsParam);\r\n    const page = {current: 1, size: 30} as ComputedPage;\r\n\r\n    onMounted(() => {\r\n      Spinner.open();\r\n\r\n      getMvList(page, null).then(data => {\r\n        // 获取 total(总数据条数) 和 size(每页数据量,有可能会被重设为其他值)\r\n        data.page && Object.assign(page, data.page);\r\n\r\n        const tagList: TagItemNode[][] = [];\r\n\r\n        // 转换结构 => {a:[{id, name}], b:[{id, name}]} => [[{id, name, group:a, value:'a;${id}'}] , ...]\r\n        Object.keys(data.tags).forEach(key => {\r\n          const property = key as keyof typeof mvTagParam;\r\n          const children = data.tags[property];\r\n          //  {a:[{id:1,name:'A'}], b:[{}] } => {a:id, b:id}\r\n          mvTagParam[property] = (children[0] && children[0].id) as string; // 1 && 0 => 0\r\n\r\n          // {id, name} => {id, name, group:key, value:`${key};${id}`}\r\n          children.forEach(item => item.value = `${item.group = key};${item.id}`);\r\n\r\n          tagList.push(children as TagItemNode[]);\r\n        });\r\n\r\n        // 添加Mv分类标签信息\r\n        tags.splice(0, tags.length, ...tagList);\r\n\r\n        // 添加Mv数据\r\n        mvList.splice(0, mvList.length, ...data.list);\r\n\r\n      }).finally(Spinner.close);\r\n    });\r\n\r\n    return {\r\n      tags, mvList, mvTagParam,\r\n\r\n      /**\r\n       * Mv分类标签被点击时, 加载最新的Mv数据列表\r\n       *\r\n       * @param event 点击事件\r\n       */\r\n      onListViewClicked(event: PointerEvent) {\r\n        const value = (event.target as HTMLElement).getAttribute('data-tag');\r\n        if (!value) {\r\n          return;\r\n        }\r\n\r\n        // 获取分类标签所属组 和 分类标签id\r\n        const [group, id] = value.split(';');\r\n\r\n        // @ts-ignore 若未改变, 则什么也不做\r\n        if (mvTagParam[group] === id) {\r\n          return;\r\n        }\r\n\r\n        // @ts-ignore 设定当前分类组对应的分类标签id\r\n        mvTagParam[group] = id;\r\n        // 重设为第一页\r\n        page.current = 1;\r\n\r\n        Spinner.open();\r\n\r\n        getMvList(page, mvTagParam).then(data => {\r\n          Object.assign(page, data.page);\r\n\r\n          mvList.splice(0, mvList.length, ...data.list);\r\n\r\n        }).finally(Spinner.close);\r\n      },\r\n\r\n      /** 加载数据到视图上(无限滚动触发点) */\r\n      loadData() {\r\n        // 若还有数据, 则发起网络请求加载歌曲数据列表\r\n        if (page.current >= 1 && page.current < page.pageCount) {\r\n          Spinner.open();\r\n\r\n          ++page.current;\r\n\r\n          getMvList(page, mvTagParam).then(data => {\r\n            Object.assign(page, data.page);\r\n\r\n            mvList.push(...data.list);\r\n\r\n          }).catch(() => --page.current).finally(Spinner.close);\r\n        }\r\n      }\r\n\r\n    };\r\n  }\r\n\r\n});\r\n","import { render } from \"./MVList.vue?vue&type=template&id=4c634498&scoped=true&ts=true\"\nimport script from \"./MVList.vue?vue&type=script&lang=ts\"\nexport * from \"./MVList.vue?vue&type=script&lang=ts\"\n\nimport \"./MVList.vue?vue&type=style&index=0&id=4c634498&scoped=true&lang=css\"\n\nimport exportComponent from \"D:\\\\SCMQ\\\\Project\\\\mq-player-vue\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-4c634498\"]])\n\nexport default __exports__","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./MVList.vue?vue&type=style&index=0&id=4c634498&scoped=true&lang=css\""],"sourceRoot":""}