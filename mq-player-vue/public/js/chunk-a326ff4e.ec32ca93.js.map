{"version":3,"sources":["webpack:///./src/renderer/views/SpecialList.vue?d1b9","webpack:///./src/renderer/views/SpecialList.vue?18e4","webpack:///./src/renderer/views/SpecialList.vue?e5f4","webpack:///./src/renderer/views/SpecialList.vue"],"names":["_withScopeId","n","_hoisted_1","_hoisted_2","class","_hoisted_3","_hoisted_4","render","_ctx","_cache","$props","$setup","$data","$options","_component_image_view","_component_grid_view","_component_modal","onClick","args","onListViewClicked","visibleTags","tag","active","specialTagParam","id","key","name","style","data","specialList","onInfiniteScroll","loadData","default","item","modelValue","cover","$event","defaultValue","_","modality","title","width","height","visible","tagModal","content","tags","_index","items","index","page","current","size","Spinner","open","then","Object","assign","splice","length","list","random","Math","forEach","children","push","finally","close","event","node","target","classList","contains","value","getAttribute","pageCount","catch","__exports__"],"mappings":"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","file":"public/js/chunk-a326ff4e.ec32ca93.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--1-1!./SpecialList.vue?vue&type=style&index=0&id=365a2750&scoped=true&lang=css\"","import { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, createTextVNode as _createTextVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-365a2750\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = [\"data-id\"]\nconst _hoisted_2 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", { class: \"item special-tag-more\" }, \"更多\", -1))\nconst _hoisted_3 = { class: \"name\" }\nconst _hoisted_4 = [\"data-id\"]\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_image_view = _resolveComponent(\"image-view\")!\n  const _component_grid_view = _resolveComponent(\"grid-view\")!\n  const _component_modal = _resolveComponent(\"modal\")!\n\n  return (_openBlock(), _createElementBlock(_Fragment, null, [\n    _createElementVNode(\"div\", {\n      class: \"v-row list-view\",\n      onClick: _cache[0] || (_cache[0] = \n//@ts-ignore\n(...args) => (_ctx.onListViewClicked && _ctx.onListViewClicked(...args)))\n    }, [\n      (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.visibleTags, (tag) => {\n        return (_openBlock(), _createElementBlock(\"div\", {\n          class: _normalizeClass([\"item\", {active: _ctx.specialTagParam.id === tag.id}]),\n          key: tag.id,\n          \"data-id\": tag.id\n        }, _toDisplayString(tag.name), 11, _hoisted_1))\n      }), 128)),\n      _hoisted_2\n    ]),\n    _createVNode(_component_grid_view, {\n      style: {\"margin-top\":\"1em\"},\n      data: _ctx.specialList,\n      \"cell-widths\": \"repeat(auto-fit, 13em)\",\n      \"cell-height\": 234,\n      onInfiniteScroll: _ctx.loadData\n    }, {\n      default: _withCtx(({item}) => [\n        _createVNode(_component_image_view, {\n          modelValue: item.cover,\n          \"onUpdate:modelValue\": ($event: any) => ((item.cover) = $event),\n          defaultValue: \"icon/special.png\"\n        }, null, 8, [\"modelValue\", \"onUpdate:modelValue\"]),\n        _createElementVNode(\"div\", _hoisted_3, _toDisplayString(item.name), 1)\n      ]),\n      _: 1\n    }, 8, [\"data\", \"onInfiniteScroll\"]),\n    _createVNode(_component_modal, {\n      modality: \"\",\n      title: \"全部分类\",\n      width: \"70%\",\n      height: \"60%\",\n      visible: _ctx.tagModal,\n      \"onUpdate:visible\": _cache[2] || (_cache[2] = ($event: any) => ((_ctx.tagModal) = $event))\n    }, {\n      content: _withCtx(() => [\n        (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.tags, (item, _index) => {\n          return (_openBlock(), _createElementBlock(_Fragment, { key: _index }, [\n            _createTextVNode(_toDisplayString(item.title) + \" \", 1),\n            _createElementVNode(\"div\", {\n              class: \"v-row list-view\",\n              onClick: _cache[1] || (_cache[1] = \n//@ts-ignore\n(...args) => (_ctx.onListViewClicked && _ctx.onListViewClicked(...args)))\n            }, [\n              (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(item.items, (tag, index) => {\n                return (_openBlock(), _createElementBlock(\"div\", {\n                  class: _normalizeClass([\"item\", {active: _ctx.specialTagParam.id === tag.id}]),\n                  key: index,\n                  \"data-id\": tag.id\n                }, _toDisplayString(tag.name), 11, _hoisted_4))\n              }), 128))\n            ])\n          ], 64))\n        }), 128))\n      ]),\n      _: 1\n    }, 8, [\"visible\"])\n  ], 64))\n}","\r\nimport {getSpecialList} from '../api';\r\nimport Spinner from '../components/Spinner';\r\n\r\nimport {ComputedPage, Special, SpecialTags, Tag} from 'src/types';\r\n\r\nimport {onMounted, reactive, ref, defineComponent} from 'vue';\r\n\r\nexport default defineComponent({\r\n  name: 'SpecialList',\r\n\r\n  setup() {\r\n    // 所有歌单分类标签\r\n    const tags = reactive<SpecialTags[]>([]);\r\n    // 可见的歌单分类标签列表\r\n    const visibleTags = reactive<Tag[]>([]);\r\n    // 歌单列表\r\n    const specialList = reactive<Special[]>([]);\r\n    // 当前已选Tag的id\r\n    const specialTagParam = reactive<Tag>({id: ''});\r\n    // 分页信息\r\n    const page = {current: 1, size: 30} as ComputedPage;\r\n\r\n    // 显示分类标签的模态框显隐控制\r\n    const tagModal = ref(false);\r\n\r\n    onMounted(() => {\r\n      Spinner.open();\r\n\r\n      getSpecialList(page, null).then(data => {\r\n        data.page && Object.assign(page, data.page);\r\n        data.tags && tags.splice(0, tags.length, ...data.tags);\r\n        specialList.splice(0, specialList.length, ...data.list);\r\n\r\n        const random = Math.random();\r\n\r\n        data.tags && data.tags.forEach(item => {\r\n          const children = item.items;\r\n          const tag = children[(random * children.length) ^ 0];\r\n          tag && visibleTags.push(tag);\r\n        });\r\n\r\n        // 断言能够获得数据\r\n        const [{items: [tag]}] = data.tags || [];\r\n        tag && Object.assign(specialTagParam, tag);\r\n\r\n      }).finally(Spinner.close);\r\n\r\n    });\r\n\r\n    return {\r\n      tags, specialList, visibleTags, tagModal, specialTagParam,\r\n\r\n      /**\r\n       * 若点击分类标签时,切换歌单数据;\r\n       * 若点击更多分类时,则打开歌单详细分类标签模态框\r\n       *\r\n       * @param event 点击事件\r\n       */\r\n      onListViewClicked(event: PointerEvent) {\r\n        const node = event.target as HTMLElement, classList = node.classList;\r\n        if (classList.contains('special-tag-more')) {\r\n          return tagModal.value = true;\r\n        }\r\n\r\n        const value = node.getAttribute('data-id');\r\n\r\n        if (value && value !== specialTagParam.id) {\r\n          specialTagParam.id = value;\r\n\r\n          Spinner.open();\r\n          page.current = 1;\r\n\r\n          getSpecialList(page, specialTagParam).then(data => {\r\n            data.page && Object.assign(page, data.page);\r\n            specialList.splice(0, specialList.length, ...data.list);\r\n\r\n          }).finally(Spinner.close);\r\n        }\r\n      },\r\n\r\n      /** 加载数据到视图上(无限滚动触发点) */\r\n      loadData() {\r\n        // 若还有数据, 则发起网络请求加载歌曲数据列表\r\n        if (page.current >= 1 && page.current < page.pageCount) {\r\n          Spinner.open();\r\n\r\n          ++page.current;\r\n\r\n          getSpecialList(page, specialTagParam).then(data => {\r\n            data.page && Object.assign(page, data.page);\r\n            specialList.push(...data.list);\r\n\r\n          }).catch(() => --page.current).finally(Spinner.close);\r\n        }\r\n      }\r\n\r\n    };\r\n\r\n  }\r\n\r\n});\r\n","import { render } from \"./SpecialList.vue?vue&type=template&id=365a2750&scoped=true&ts=true\"\nimport script from \"./SpecialList.vue?vue&type=script&lang=ts\"\nexport * from \"./SpecialList.vue?vue&type=script&lang=ts\"\n\nimport \"./SpecialList.vue?vue&type=style&index=0&id=365a2750&scoped=true&lang=css\"\n\nimport exportComponent from \"D:\\\\SCMQ\\\\Project\\\\mq-player-vue\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-365a2750\"]])\n\nexport default __exports__"],"sourceRoot":""}