import{d as B,a6 as y,p as $,c as o,a as h,b as _,F as g,g as z,e as v,j as L,o as i,f as b,t as u,E as D,z as k,cs as E,ad as N,i as V,l as I}from"./x42m4qf7.js";import{d as S}from"./mpwglf32.js";import{_ as j}from"./hysh9qi4.js";const A={class:"col card-item grow"},M={class:"row"},R=["onClick"],q={key:0},G=["onClick"],H={key:1},J={class:"row"},T=B({__name:"FileSystem",setup(K){const w=[{title:"åºå·",field:"id",width:"60px",fixed:"left",align:"center"},{title:"åç§°",field:"name",width:"minmax(160px, 1fr)"},{title:"å¤§å°",field:"size",width:"160px",thAlign:"center",align:"right"},{title:"æ“ä½œ",field:"oper",width:"108px",align:"center"}],n=y([]),f=y([]),C=e=>{c(n.value.push({name:e.name,handle:e.handle})-1)},c=async e=>{let l=n.value,d=l[e],t=[],a=-1,m,p;try{for await(let[r,s]of d.handle.entries())m=s.kind!=="file",t[++a]={name:r,handle:s,type:m,size:m?"":L((await s.getFile()).size)}}catch{return c(--e)}e<l.length-1&&(n.value=l.slice(0,++e)),f.value=t.sort((r,s)=>(p=(r.type?0:1)-(s.type?0:1),p==0?r.name.localeCompare(s.name):p))},F=async e=>{!e.type&&e.handle.getFile().then(l=>S(l,e.name))},x=async e=>{try{V(),await e.handle.remove({recursive:!0}),await c(n.value.length-1)}finally{I()}};return $(async()=>{const e=await navigator.storage.getDirectory();n.value=[{name:e.name||"root",handle:e}],await c(0)}),(e,l)=>{const d=D;return i(),o("div",A,[h("div",M,[(i(!0),o(g,null,z(n.value,(t,a)=>(i(),o(g,{key:a},[h("div",{class:"path-item",onClick:m=>c(a)},u(t.name),9,R),a<n.value.length-1?(i(),o("span",q,"/")):b("",!0)],64))),128))]),_(j,{columns:w,data:f.value,"cell-height":48},{name:v(({row:t})=>[t.type?(i(),o("div",{key:0,class:"dir",onClick:a=>C(t)},"ðŸ“ "+u(t.name),9,G)):(i(),o("span",H,"ðŸ“„ "+u(t.name),1))]),oper:v(({row:t})=>[h("div",J,[_(d,{circle:"",type:"primary",icon:k(E),onClick:a=>F(t),disabled:t.type},null,8,["icon","onClick","disabled"]),_(d,{circle:"",type:"danger",icon:k(N),onClick:a=>x(t)},null,8,["icon","onClick"])])]),_:1},8,["data"])])}}});export{T as default};
