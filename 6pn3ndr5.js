import{d as B,s as y,T as $,c as o,a as p,b as _,F as g,g as L,e as v,j as b,o as i,f as z,t as u,E as D,x as k,a5 as E,G as N,i as V,l as I}from"./dvuu6xne.js";import{d as S}from"./mpwglf32.js";import{_ as j}from"./o0bkrff7.js";const A={class:"col card-item grow"},G={class:"row"},M=["onClick"],R={key:0},T=["onClick"],q={key:1},H={class:"row"},Q=B({__name:"FileSystem",setup(J){const w=[{title:"åºå·",field:"id",width:"60px",fixed:"left",align:"center"},{title:"åç§°",field:"name",width:"minmax(160px, 1fr)"},{title:"å¤§å°",field:"size",width:"160px",thAlign:"center",align:"right"},{title:"æ“ä½œ",field:"oper",width:"108px",align:"center"}],n=y([]),f=y([]),C=e=>{c(n.value.push({name:e.name,handle:e.handle})-1)},c=async e=>{let l=n.value,d=l[e],t=[],a=-1,m,h;try{for await(let[r,s]of d.handle.entries())m=s.kind!=="file",t[++a]={name:r,handle:s,type:m,size:m?"":b((await s.getFile()).size)}}catch{return c(--e)}e<l.length-1&&(n.value=l.slice(0,++e)),f.value=t.sort((r,s)=>(h=(r.type?0:1)-(s.type?0:1),h==0?r.name.localeCompare(s.name):h))},F=async e=>{!e.type&&e.handle.getFile().then(l=>S(l,e.name))},x=async e=>{try{V(),await e.handle.remove({recursive:!0}),await c(n.value.length-1)}finally{I()}};return $(async()=>{const e=await navigator.storage.getDirectory();n.value=[{name:e.name||"root",handle:e}],await c(0)}),(e,l)=>{const d=D;return i(),o("div",A,[p("div",G,[(i(!0),o(g,null,L(n.value,(t,a)=>(i(),o(g,{key:a},[p("div",{class:"path-item",onClick:m=>c(a)},u(t.name),9,M),a<n.value.length-1?(i(),o("span",R,"/")):z("",!0)],64))),128))]),_(j,{columns:w,data:f.value,"cell-height":48},{name:v(({row:t})=>[t.type?(i(),o("div",{key:0,class:"dir",onClick:a=>C(t)},"ðŸ“ "+u(t.name),9,T)):(i(),o("span",q,"ðŸ“„ "+u(t.name),1))]),oper:v(({row:t})=>[p("div",H,[_(d,{circle:"",type:"primary",icon:k(E),onClick:a=>F(t),disabled:t.type},null,8,["icon","onClick","disabled"]),_(d,{circle:"",type:"danger",icon:k(N),onClick:a=>x(t)},null,8,["icon","onClick"])])]),_:1},8,["data"])])}}});export{Q as default};
